<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="processing-ui" version="3.0">
   
    <display-name>access</display-name>
    <description>Access Control Web Application</description>

    <filter>
        <filter-name>AccessControlFilter</filter-name>
        <filter-class>ca.nrc.cadc.web.WebAccessControlFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>AccessControlFilter</filter-name>
        <url-pattern>/control/*</url-pattern>
    </filter-mapping>

    <servlet>
        <servlet-name>SSOCookieAgent</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.SSOCookieAgentImpl</servlet-class>
        <init-param>
            <param-name>SSOURI</param-name>
            <param-value>/access/sso</param-value>
        </init-param>
    </servlet>

    <servlet>
        <servlet-name>DomainServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.DomainServlet</servlet-class>
        <init-param>
            <param-name>ConsentURI</param-name>
            <param-value>/access/domain</param-value>
        </init-param>
    </servlet>

    <servlet>
        <servlet-name>SSOLoginServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.SSOLoginServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>SSOLogoutServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.SSOLogoutServlet</servlet-class>
        <load-on-startup>3</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>logControl</servlet-name>
        <servlet-class>ca.nrc.cadc.log.LogControlServlet</servlet-class>
        
        <init-param>
            <param-name>logLevel</param-name>
            <param-value>info</param-value>
        </init-param>
        <init-param>
            <param-name>logLevelPackages</param-name>
            <param-value>
                ca.nrc.cadc.accesscontrol 
                ca.nrc.cadc.auth
                ca.nrc.cadc.vosi
                ca.nrc.cadc.reg
            </param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>ProxyServlet</servlet-name>
        <servlet-class>org.opencadc.proxy.ProxyServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>PasswordResetRequestServlet</servlet-name>
        <servlet-class>
            ca.nrc.cadc.accesscontrol.web.PasswordResetRequestServlet
        </servlet-class>
    </servlet>

    <servlet>
        <servlet-name>PasswordResetServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.PasswordResetServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>UserInfoServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.UserInfoServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>I18NServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.I18NServlet</servlet-class>
        <load-on-startup>3</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>UserCertificateLinker</servlet-name>
        <servlet-class>
            ca.nrc.cadc.accesscontrol.web.UserCertificateLinker
        </servlet-class>
    </servlet>

    <servlet>
        <servlet-name>AvailabilityServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.vosi.AvailabilityServlet</servlet-class>
        <init-param>
            <param-name>ca.nrc.cadc.vosi.AvailabilityPlugin</param-name>
            <param-value>ca.nrc.cadc.accesscontrol.web.ServiceAvailability</param-value>
        </init-param>
        <load-on-startup>3</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>ErrorServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.ErrorServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>ConsentCookieServlet</servlet-name>
        <servlet-class>ca.nrc.cadc.accesscontrol.web.ConsentCookieServlet</servlet-class>
        <init-param>
            <param-name>ConsentURI</param-name>
            <param-value>/access/domain</param-value>
        </init-param>
    </servlet>

    <servlet-mapping>
        <servlet-name>logControl</servlet-name>
        <url-pattern>/logControl</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>SSOCookieAgent</servlet-name>
        <url-pattern>/sso/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>DomainServlet</servlet-name>
        <url-pattern>/domain</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>SSOLoginServlet</servlet-name>
        <url-pattern>/login/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>SSOLogoutServlet</servlet-name>
        <url-pattern>/logout/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>I18NServlet</servlet-name>
        <url-pattern>/i18n/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>ProxyServlet</servlet-name>
        <url-pattern>/control/proxy</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>UserInfoServlet</servlet-name>
        <url-pattern>/control/user</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>PasswordResetRequestServlet</servlet-name>
        <url-pattern>/passwordResetRequest</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>PasswordResetServlet</servlet-name>
        <url-pattern>/control/resetPassword</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>UserCertificateLinker</servlet-name>
        <url-pattern>/control/userCertificate</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>AvailabilityServlet</servlet-name>
        <url-pattern>/availability</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>ErrorServlet</servlet-name>
        <url-pattern>/error/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>ConsentCookieServlet</servlet-name>
        <url-pattern>/consent</url-pattern>
    </servlet-mapping>

    <error-page>
        <exception-type>java.lang.IllegalArgumentException</exception-type>
        <location>/error/400</location>
    </error-page>

    <error-page>
        <exception-type>java.security.AccessControlException</exception-type>
        <location>/error/401</location>
    </error-page>

    <error-page>
        <exception-type>ca.nrc.cadc.auth.NotAuthenticatedException</exception-type>
        <location>/error/401</location>
    </error-page>

    <error-page>
        <error-code>400</error-code>
        <location>/error/400</location>
    </error-page>

    <error-page>
        <error-code>404</error-code>
        <location>/error/404</location>
    </error-page>

    <error-page>
        <error-code>409</error-code>
        <location>/error/409</location>
    </error-page>

    <error-page>
        <error-code>500</error-code>
        <location>/error/500</location>
    </error-page>

</web-app>
